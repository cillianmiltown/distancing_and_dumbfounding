---
title: "Distancing and Moral Dumbfounding:"
subtitle: " Facilitating the Identification of Reasons"
author: "Cillian McHugh"
institute: "London Reasoning Workshop - 25th July 2023"
bibliography: "resources/bib/My Library.bib"
csl: resources/bib/apa.csl
format:
  revealjs:
    transition: none
    transition-speed: fast
    slide-number: false
    logo: "resources/img/ul-psychology-logos.png"
    footer: "Cillian McHugh - 25/7/23"
    theme: resources/mytheme.scss
    chalkboard: 
      buttons: true
editor: source
---


```{r ch5setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
options(scipen=1, digits=2)
# knitr::opts_chunk$set(fig.path='figure/graphics-', 
#                       cache.path='cache/graphics-', 
#                       fig.align='center',
#                       external=TRUE,
#                       echo=FALSE,
#                       warning=FALSE,
#                       fig.pos='H'
# )
```

```{r load_librariesch5}
#rm(list = ls())
library(citr)
#install.packages("sjstats")
library(plyr)
library(foreign)
library(car)
library(desnum)
library(ggplot2)
library(extrafont)
#devtools::install_github("crsh/papaja")
library(papaja)
#library("dplyr")
library("afex")
library("tibble")
library(scales)
#install.packages("metap")
library(metap)
library(pwr)
library(lsr)
#install.packages("sjstats")
library(sjstats)
library(DescTools)
#inatall.packages("ggstatsplot")
#library(ggstatsplot)
library(VGAM)
library(nnet)
library(mlogit)
library(reshape2)
library(ggpubr)
library(gridExtra)
library(grid)
library(gghalves)


library(tidyverse)
library(flextable)
library(ftExtra)
library(officer)
library(knitr)

#devtools::install_github("benmarwick/wordcountaddin")
#library(wordcountaddin)
#wordcountaddin::text_stats("distancing_june_rw.Rmd")
getwd()
```


```{r colors}

r_slidetot <- 82


#Color Format
colFmt = function(x,color){
  outputFormat = knitr::opts_knit$get("rmarkdown.pandoc.to")
  if(outputFormat == 'latex')
    paste("\\textcolor{",color,"}{",x,"}",sep="")
  else if(outputFormat == 'html')
    paste("<font color='",color,"'>",x,"</font>",sep="")
  else
    x
}

#rgb(255, 0, 0);

sentiment <- '#ff744e'
rational1 <- '#2faace'
rational <- '#248aa8'
conflict1 <- '#7d0552'
conflict <- '#2f8d2f'
cogload <- '#a0522d'
dual <- '#b93b8f'
lightgrey <- '#c0c0c0'


# \definecolor{sentiment}{RGB}{255, 115, 115} #ff7300 or #ff744e
# 
# % \definecolor{rational}{RGB}{47,170,206} #2faace
# 
# \definecolor{rational}{RGB}{36, 138, 168} #248aa8
# 
# % \definecolor{conflict}{RGB}{125, 5, 82} #7d0552
# 
# \definecolor{cogload}{RGB}{160, 82, 45} #a0522d
# 
# \definecolor{conflict}{RGB}{47,141,47} #2f8d2f
# 
# \definecolor{dual}{RGB}{185, 59, 143} #b93b8f
# 
# \definecolor{lightgrey}{RGB}{192,192,192} #c0c0c0


# plotting:
# red dumbfounded
# yellow reasons
# blue nothing wrong
dumb_palette <- c('#ff3801','#ff4c1b','#ff6035','#ff744e','#ff8868','#ff9c81','#ffb09b','#ff744e') # https://www.colorhexa.com/ff744e
reasons_palette <- c('#ffb701','#ffbf1b','#ffc635','#ffcd4e','#ffd468','#ffdb81','#ffe39b','#ffcd4e') #https://www.colorhexa.com/ffcd4e
nothing_palette <- c('#0149ff','#1b5bff','#356eff','#4e80ff','#6892ff','#81a5ff','#9bb7ff','#4e80ff') # https://www.colorhexa.com/4e80ff




```

## Overview

- Background to Moral Dumbfounding
- Moral Dumbfounding & Dual Processes
- The Current Studies
- Looking Forward



## Moral Dilemmas

:::{.incremental}
- Is it wrong to steal a drug to save a loved one?/Is it wrong to demand profit from a life saving drug?
- Is it wrong to push someone off a bridge to save five?
- Is it wrong to eat meat from a dead body?
- Is it wrong for a brother and sister (Julie and Mark) to make love? (using multiple forms of contraception)<br><br>

- <font color="#FF7575">**Have you got a reason for your Judgement?**</font>
:::

## What Moral Dumbfounding?

. . .

Moral Dumbfounding occurs when people <font color="ff744e">defend</font> a moral judgement even though they cannot provide a <font color="6892ff">reason</font> in support of this judgment [@haidt_moral_2000; @mchugh_searching_2017]<br><br>

:::{.incremental}

- Admission of not having reasons 
- Unsupported declarations
  - <font size="54px" color="ff744e">"*It's just wrong *"</font>

- Typically occurs for harmless taboos

:::


## Dumbfounded by *Incest*

<iframe width="900" height="600" src="resources/video/Participant_26_subs.mp4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>




## Influence of Moral Dumbfounding

- Moral Dumbfounding is cited as evidence for
  - ***`r colFmt("intuitionist",sentiment)`*** or ***`r colFmt("dual-process",dual)`*** theories of moral judgement 
    - e.g., @crockett_models_2013; @cushman_action_2013; @greene_secret_2008; @haidt_emotional_2001
  - over more ***`r colFmt("rationalist",rational)`*** approaches
    - e.g., @kohlberg_stages_1969; @topolski_choosing_2013


## Research on Moral Dumbfounding {.smaller}

::: {.fragment .fade-in fragment-index=1}
- Original unpublished study [@haidt_moral_2000]
:::
::: {.fragment .fade-in fragment-index=2}
- Replication and development of methods [@mchugh_searching_2017]
:::
::: {.fragment .fade-in fragment-index=3}
- Replication in non-Western samples [China, India, MENA, @mchugh_just_2023]
:::
::: {.fragment .fade-in fragment-index=4}
- <font color="6892ff">Principle/reason</font>-based challenges [@sneddon_social_2007; @gray_myth_2014; @jacobson_moral_2012; @stanley_reasonbased_2019]
  - @royzman_curious_2015
:::


::: {.fragment .fade-in fragment-index=6}
::: {.fragment .highlight-red fragment-index=8}
- Robust to challenges [@mchugh_reasons_2020]
:::
:::

::: {.fragment .fade-in fragment-index=7}
::: {.fragment .highlight-red fragment-index=9}
- Dual-Processes/Cognitive Load [@mchugh_cognitive_2023]
:::
:::


## Robust to Challenges

:::{.incremental}
- @royzman_curious_2015 exclusion criteria
  - Endorsing

- @mchugh_reasons_2020 exclusion criteria
  - Endorsing, Articulating, *and* Applying
  
- False Exclusions
  - Selected "nothing wrong"

:::

## Robust to Challenges

![False exclusions by exclusion criteria [@mchugh_reasons_2020]](resources/img/exclusions.png){.fragment height=500}


## Robust to Challenges

![Rates of Dumbfounding depending on exclusion criteria [@mchugh_reasons_2020]](resources/img/S3reasonsfig2.png){.fragment height=500}



# Moral Dumbfounding & Dual Processes


## Moral Dumbfounding & Dual Processes {.smaller}


- <font color="2f8d2f">Conflict</font> in <font color="b93b8f">dual-process</font> occurs when
  - a <font color="ff744e">habitual (System 1)</font> response is <font color="2f8d2f">different</font>
  - from a response that results from <font color="248aa8">deliberation (System 2)</font>


Three response options in the <font color="2f8d2f">dumbfounding paradigm</font>

::: {.fragment .highlight-blue}
  - It’s wrong and I can provide a valid reason
  
:::
::: {.fragment .highlight-red}
  - It’s wrong but I can’t think of a reason

:::
::: {.fragment .highlight-red}
  - There is nothing wrong (competing intuitions)

:::


## Moral Dumbfounding & Cognitive Load {.smaller}

- Manipulations of  <font color="a0522d">Cognitive load</font> are known to inhibit <font color="248aa8">deliberative responding</font>



- Recall the three response options in <font color="2f8d2f">dumbfounding</font>
  - <font color="248aa8">It's wrong and I can provide a valid reason (reason-giving)</font>
  - <font color="ff744e">It's wrong but I can't think of a reason (dumbfounded) </font>
  - <font color="ff744e">There is nothing wrong (competing intuitions) (nothing-wrong)</font>

**<font color="a0522d">Cognitive load</font> & dumbfounded responding**


<font color="248aa8">**&#x2193; &#x2193; &#x2193; &#x2193;** &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Reason-giving &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **&#x2193; &#x2193; &#x2193; &#x2193;** </font>

<font color="ff744e">**&#x2191;** &nbsp;&nbsp; **&#x2191;** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dumbfounded  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  **&#x2191; &#x2191; &#x2191;**</font> 

<font color="ff744e">**&#x2191;** &nbsp;&nbsp; **&#x2191;** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nothing-wrong &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **&#x2191;**</font>


## Dumbfounding and Cognitive Load

![@mchugh_cognitive_2023](resources/img/cog_load.png){height="500"}




## Facilitating Deliberative Responding?

:::{.incremental}
- Reason-giving should increase under manipulations that encourage deliberative thinking
- Drawing on construal-level theory [@liberman_effect_2002; @forster_temporal_2004]
  - Distancing manipulations
    - Psychological distancing
    - Temporal distancing

:::



## Moral Dumbfounding & Distancing {.smaller}

:::{.incremental}
- <font color="a0522d">Distancing</font> manipulations ***facilitate*** <font color="248aa8">deliberative responding</font> [@liberman_effect_2002]

- Three response options in <font color="2f8d2f">dumbfounding</font>
  - <font color="248aa8">Reason-giving (deliberative)</font>
  - <font color="ff744e">Dumbfounded (intuitive) </font>
  - <font color="ff744e">Nothing-wrong (competing intuitions)</font>

:::{.fragment}

**<font color="a0522d">Distancing</font> & dumbfounding**

<font color="248aa8">**&#x2191; &#x2191; &#x2191; &#x2191;** &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Reason-giving &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **&#x2191; &#x2191; &#x2191; &#x2191;** </font>

<font color="ff744e">**&#x2193;** &nbsp;&nbsp; **&#x2193;** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dumbfounded  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  **&#x2193; &#x2193; &#x2193;**</font> 

<font color="ff744e">**&#x2193;** &nbsp;&nbsp; **&#x2193;** &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nothing-wrong &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; **&#x2193;**</font>
:::
:::


## The Current Studies {.smaller}

:::{.incremental}
- 8 (Pilot) Studies
- All between-subjects design
  - Psychological Distance (increased vs control/decreased)
  - Temporal Distance (increased vs decreased/control)
- Materials
  - *Julie & Mark* (incest) scenario (Studies 1-5, & 8)
  - *Jennifer* (cannibal) scenario (Studies 6 & 7)
- Manipulations
  - "Anne" vignette / imagined assignment (Studies 1-7)
  - Modified scenario (Study 8)
  
:::


```{r apriori_power_analyses_reporting}

large <- pwr.chisq.test(w=.35,df=(3-1),sig.level = .05, power=.8)
med   <- pwr.chisq.test(w=.21,df=(3-1),sig.level = .05, power=.8)
small <- pwr.chisq.test(w=.07,df=(3-1),sig.level = .05, power=.8)

round(large$N)
# https://www.real-statistics.com/chi-square-and-f-distributions/effect-size-chi-square/

```

## A Note on Power

A priori power analysis indicated that in order to detect:

- Large effect size (*V* = .35) with 80% power requires
  - A sample of *N* = `r round(large$N)` participants
- Medium effect size (*V* = .21) with 80% power requires
  - A sample of *N* = `r round(med$N)` participants 
- Small effect size (*V* = . 07) with 80% power requires
  - A sample of *N* = `r round(small$N)` participants


## Overview of Current Studies

```{r}
#| label: apafg-summaryfigure
#| apa-cap: Overview of Pilot Studies 1-8.
#| apa-note: Sample sizes listed are the total samples that passed the attention checks, without exclusion based on responses to Need for Closure, followed by the sample size when excluding participants who failed the Need for Closure attention check.
#| include: true
knitr::include_graphics("resources/img/summary_figure.png")
```

## Julie and Mark Scenario {.smaller}

> Julie and Mark, who are brother and sister, are travelling together in France. They are both on summer vacation from college. One night they are staying alone in a cabin near the beach. They decide that it would be interesting and fun if they tried making love. At very least it would be a new experience for each of them. Julie was already taking birth control pills, but Mark uses a condom too, just to be safe. They both enjoy it, but they decide not to do it again. They keep that night as a special secret between them, which makes them feel even closer to each other.

## Jennifer Scenario {.smaller}

> Jennifer works in a medical school pathology lab as a research assistant. The lab prepares human cadavers that are used to teach medical students about anatomy. The cadavers come from people who had donated their body to science for research. One night Jennifer is leaving the lab when she sees a body that is going to be discarded the next day. Jennifer was a vegetarian, for moral reasons. She thought it was wrong to kill animals for food. But then, when she saw a body about to be cremated, she thought it was irrational to waste perfectly edible meat. So she cut off a piece of flesh, and took it home and cooked it. The person had died recently of a heart attack, and she cooked the meat thoroughly, so there was no risk of disease.

# The Current Studies

## Study 1: Method {.smaller}

```{r load distancing 1 data}

rm(list = ls())

load("pilot_data/loaded_data/one.RData")
df3 <- one

df4 <- df3[which(df3$condition=="1manip"),]
df5 <- df3[which(df3$condition=="2control"),]


```

:::{.fragment}

#### Manipulation

- **Psychological Distance**: Increased vs Control
- Anne vignette: two levels - present and absent

:::

:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

::: 
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::

## Anne Vignette {.smaller}

Anne is a student of philosophy. She generally shows a good understanding of the subject matter, and this is reflected in her grades. Sometimes, however, she may adopt a position on an issue and struggle (or even fail) to defend it.<br><br>

She is currently taking a course in ethics and has been asked to study the following scenario.<br><br>

How should Anne judge the actions of the two people involved?<br><br>

What reasons would you use to explain why she should make that judgement?

## Critical Slide

Julie and Mark's behaviour did not harm anyone, how can there be anything wrong with what they did?

- It's wrong and I can provide a valid reason (reason-giving)

- It's wrong but I can't think of a reason (dumbfounding)

- There is nothing wrong (nothing-wrong)

```{r dch5s1change in judgement}

# create variables for reporting t.tests
t <- t.test(df3$InJu1,df3$InJu2, paired = TRUE)

#chisquare test function

custom_chi <- function(x,y){
  a <- length(x)
  b <- length(y)
  c <- rep(1, a)
  d <- rep(2, b)
  e <- c(c,d)
  f <- c(x, y)
  
  g <- data.frame(e,f)
  h <- table(g$e,g$f)
  suppressWarnings(chisq.test(h))
}

c <- suppressWarnings(custom_chi(df3$InJu1,df3$InJu2))

changed_num <- function(x, judgement_1, judgement_2){
  b <- b <- x[which(x$Ju1_bin==judgement_1 & x$Ju2_bin==judgement_2),]
  length(b$Ju1_bin)
  
}

tot_changed_num <- function(x, query){
  
  c <- cbind.data.frame(x$Ju1_bin[which(x$Ju1_bin!=x$Ju2_bin)],x$Ju2_bin[which(x$Ju1_bin!=x$Ju2_bin)])
  colnames(c) <- c("initial_judgement","revised_judgement")
  
  c
  if(query == "table") print(c)
  if(query == "total") print(length(c$initial_judgement))}

```

```{r dcheckingchanges1}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)


```

## Study 1: Results

:::{.fragment}
- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$Ju1_bin)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (Experimental group *N* = `r sum(df3$condition=="1manip")`; Control group *N* = `r sum(df3$condition=="2control")`)

:::

```{r}
#| label: dprepch5S1fig2
#| include: false

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


y <- table(df3$condition,df3$Dumb_incl_string)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="1manip"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="1manip"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="1manip"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="2control"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="2control"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="2control"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```


```{r dch5S1fig2criticalcondition_old, include=FALSE}


g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Distanced","Control")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")



```

## Study 1: Results

```{r}
#| label: apafg-dch5S1fig2criticalcondition
#| include: true
#| fig-height: 5
#| apa-cap: "Study 1: Responses to critical slide for the experimental group (N = 60) and the control group (N = 60); (error bars represent standard error of the proportion)"
suppressWarnings(print(g))

```


```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 1")
g1_col <- p
#load("plots_col.RData")
save(g1_col, file = "plots_col.RData")

```

## Study 2: Method {.smaller}

```{r load distancing 2 data}
rm(list = ls())

load("pilot_data/loaded_data/two.RData")
df3 <- two
dftot <- two_tot

#df3 <- two_tot

df4 <- df3[which(df3$condition=="1manip"),]
df5 <- df3[which(df3$condition=="2control"),]




```


:::{.fragment}
#### Manipulation

- **Psychological Distance**: Increased vs Control
- Anne vignette: two levels - present and absent

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::

## Anne Vignette {.smaller}

Anne is a student of philosophy. She generally shows a good understanding of the subject matter, and this is reflected in her grades. Sometimes, however, she adopts a position on an issue in class and struggles (or fails) to defend it when challenged by others.
<br><br>

She is currently taking a course in ethics and has been asked to study the following scenario.
<br><br>

While reading the story on the next page, try to imagine how the philosophy student Anne will judge the actions of the two people.
<br><br>

In particular try to think about reasons she may use to defend her judgement.
<br><br>

Try to think about the story from Anne's perspective rather than your own.

## Study 2: Results

```{r dch5s2change in judgement}

# create variables for reporting t.tests
t <- t.test(df3$InJu1,df3$InJu2, paired = TRUE)

#chisquare test function

custom_chi <- function(x,y){
  a <- length(x)
  b <- length(y)
  c <- rep(1, a)
  d <- rep(2, b)
  e <- c(c,d)
  f <- c(x, y)
  
  g <- data.frame(e,f)
  h <- table(g$e,g$f)
  suppressWarnings(chisq.test(h))
}

c <- suppressWarnings(custom_chi(df3$InJu1,df3$InJu2))

changed_num <- function(x, judgement_1, judgement_2){
  b <- b <- x[which(x$Ju1_bin==judgement_1 & x$Ju2_bin==judgement_2),]
  length(b$Ju1_bin)
  
}

tot_changed_num <- function(x, query){
  
  c <- cbind.data.frame(x$Ju1_bin[which(x$Ju1_bin!=x$Ju2_bin)],x$Ju2_bin[which(x$Ju1_bin!=x$Ju2_bin)])
  colnames(c) <- c("initial_judgement","revised_judgement")
  
  c
  if(query == "table") print(c)
  if(query == "total") print(length(c$initial_judgement))}

```

```{r checkingchangesd2}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)

chisq.test(table(dftot$InCS,dftot$condition))
```

:::{.fragment}

- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (Experimental group *N* = `r sum(df3$condition=="1manip")`; Control group *N* = `r sum(df3$condition=="2control")`)

:::

```{r}
#| label: dprepch5S2fig2
#| include: false

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="1manip"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="1manip"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="1manip"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="1manip"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="2control"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="2control"),])
  ,se_fun(x[which(x$condition=="2control"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="2control"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```


```{r dch5S2fig2criticalcondition_old, include=FALSE}


g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Distanced","Control")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")



```

## Study 2: Results

```{r}
#| label: apafg-dch5S2fig2criticalcondition
#| include: true
#| fig-height: 5
#| apa-cap: "Study 1: Responses to critical slide for the experimental group (N = 60) and the control group (N = 60); (error bars represent standard error of the proportion)"
suppressWarnings(print(g))

```



```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 2")
g2_col <- p
load("plots_col.RData")
save(g1_col, g2_col, file = "plots_col.RData")

```

## Study 3: Method {.smaller}

```{r load distancing 3 data}

rm(list = ls())

load("pilot_data/loaded_data/three.RData")
df3 <- three
dftot <- three_tot
#df3 <- three_tot

df1x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_3/anne_short_b.sav', to.data.frame = TRUE)
df2x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_3/anne_long_b.sav', to.data.frame = TRUE)

N <- length(df1x$gender)+length(df2x$gender)
rm(df1x,df2x)

```


:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Deceased
- Anne vignette: two levels - 5 week deadline vs today

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::


## Anne Vignette: Increased {.smaller}

Anne is a student of philosophy. She generally shows a good understanding of the subject matter, and this is reflected in her grades. Sometimes, however, she may adopt a position on an issue and struggle (or even fail) to defend it.<br><br>

She is currently taking a course in ethics. For this ethics course, Anne and has been asked to study the following scenario. She must identify if the behaviour described is right or wrong, and provide reasons for her judgement. [**She must complete and submit this assignment within the next five weeks**]{.underline}.<br><br>

While reading the story on the next page, try to think about the story from Anne's perspective rather than your own.

## Anne Vignette: Decreased {.smaller}

Anne is a student of philosophy. She generally shows a good understanding of the subject matter, and this is reflected in her grades. Sometimes, however, she may adopt a position on an issue and struggle (or even fail) to defend it.<br><br>

She is currently taking a course in ethics. For this ethics course, Anne and has been asked to study the following scenario. She must identify if the behaviour described is right or wrong, and provide reasons for her judgement. [**She must complete and submit this assignment today**]{.underline}.<br><br>

While reading the story on the next page, try to think about the story from Anne’s perspective rather than your own.


```{r adch5s3change in judgement}
df3 <- three
# create variables for reporting t.tests
t <- t.test(df3$InJu1,df3$InJu2, paired = TRUE)

#chisquare test function

custom_chi <- function(x,y){
  a <- length(x)
  b <- length(y)
  c <- rep(1, a)
  d <- rep(2, b)
  e <- c(c,d)
  f <- c(x, y)
  
  g <- data.frame(e,f)
  h <- table(g$e,g$f)
  suppressWarnings(chisq.test(h))
}

c <- suppressWarnings(custom_chi(df3$InJu1,df3$InJu2))

changed_num <- function(x, judgement_1, judgement_2){
  b <- b <- x[which(x$Ju1_bin==judgement_1 & x$Ju2_bin==judgement_2),]
  length(b$Ju1_bin)
  
}

tot_changed_num <- function(x, query){
  
  c <- cbind.data.frame(x$Ju1_bin[which(x$Ju1_bin!=x$Ju2_bin)],x$Ju2_bin[which(x$Ju1_bin!=x$Ju2_bin)])
  colnames(c) <- c("initial_judgement","revised_judgement")
  
  c
  if(query == "table") print(c)
  if(query == "total") print(length(c$initial_judgement))}

```

```{r acheckingchangesd3}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)


```

## Study 3: Results


- A significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (increased temporal distance group *N* = `r sum(df3$condition=="long")`; decreased temporal distance group *N* = `r sum(df3$condition=="short")`)


## Study 3: Results


```{r}
#| include: false

df3 <- three

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
#y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="short"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```

```{r}
#| include: false

table(dftot$condition)

g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Increased","Decreased")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")


```

```{r}
#| label: apafg-dch5S3fig2criticalconditionNoExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Pilot Study 3: Responses to critical slide for the increased temporal distance group (N = 53) and the reduced temporal distance group (N = 52); (No exclusions; error bars represent standard error of the proportion)"

suppressWarnings(print(g))

```


```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 3")
g3_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, file = "plots_col.RData")

```

## Study 4: Method {.smaller}

```{r}
#| label: loadDistancingData4
#| include: false


load("pilot_data/loaded_data/four.RData")
df3 <- four
dftot <- four_tot

variable.names(df3)

df3$crt_tot

#df3 <- four_tot
```

(attempted replication of Study 3)

:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Deceased
- Anne vignette: two levels - 5 week deadline vs today

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::

## Study 4: Results


```{r prepch5Sd50fig2}

# y <- table(df3$condition,df3$InCS)
# y <- as.data.frame(y)
# #colnames(y) <- c("InCS","condition","Freq","perc")
# 
# z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
# perc <- z$Freq
# test <- cbind(y,perc)
# test$condition
# test


# y <- table(df3$condition,df3$Dumb_incl_string)
# y <- as.data.frame(y)
# colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
  a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
  b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
  #levels(as.factor(df3$condition))[1]
  
  ay <- as.data.frame(table(a$InCS,a$condition))
  by <- as.data.frame(table(b$InCS,b$condition))
  
  aperc <- ay$Freq/length(a$gender)
  ay <- cbind(ay,aperc)
  colnames(ay) <- c("InCS","condition","Freq","perc")
  
  bperc <- by$Freq/length(b$gender)
  by <- cbind(by,bperc)
  colnames(by) <- c("InCS","condition","Freq","perc")
  
  c <- rbind(ay,by)
  
  c
}

test <- ab_graph()


rm(x,y)
```

- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (increased temporal distance group *N* = `r sum(df3$condition=="long")`; decreased temporal distance group *N* = `r sum(df3$condition=="short")`)


## Study 4: Results


```{r}
#| include: false

df3 <- four

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
#y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="short"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

table(dftot$condition)

rm(x,y)
```

```{r}
#| include: false

table(dftot$condition)

g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Increased","Decreased")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")


```

```{r}
#| label: apafg-dch5S4fig2criticalconditionNoExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Pilot Study 4: Responses to critical slide for the increased temporal distance group (N = 67) and the reduced temporal distance group (N = 75); (No exclusions; error bars represent standard error of the proportion)"

suppressWarnings(print(g))

```



```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 4")
g4_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, g4_col, file = "plots_col.RData")

```

## Study 5 Method {.smaller}


```{r load distancing 5 data}
rm(list = ls())

load("pilot_data/loaded_data/five.RData")
df3 <- five
dftot <- five_tot


df1x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_5/shorttime_shortpsy.sav', to.data.frame = TRUE)
df2x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_5/longtime_shortpsy.sav', to.data.frame = TRUE)
  
N <- length(df1x$gender)+length(df2x$gender)
rm(df1x,df2x)

#df3 <- five_tot
```

:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Deceased
- Anne style vignette in first person: two levels - 5 week deadline vs today

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::


## Manipulation Vignett: Increased

Imagine you taking a philosophy course on ethics. For this ethics course you have been asked to study the scenario below.<br><br>

You must identify if the behaviour described is right or wrong, and provide reasons for your judgement. [**Imagine you must complete and submit this assignment within the next five weeks**]{.underline}.<br>



## Manipulation Vignett: Decreased

Imagine you taking a philosophy course on ethics. For this ethics course you have been asked to study the scenario below.<br><br>

You must identify if the behaviour described is right or wrong, and provide reasons for your judgement. [**Imagine you must complete and submit this assignment today**]{.underline}.<br>


## Study 5: Results


```{r dch5s4change in judgement}

# create variables for reporting t.tests
t <- t.test(df3$InJu1,df3$InJu2, paired = TRUE)

#chisquare test function

custom_chi <- function(x,y){
  a <- length(x)
  b <- length(y)
  c <- rep(1, a)
  d <- rep(2, b)
  e <- c(c,d)
  f <- c(x, y)
  
  g <- data.frame(e,f)
  h <- table(g$e,g$f)
  suppressWarnings(chisq.test(h))
}

c <- suppressWarnings(custom_chi(df3$InJu1,df3$InJu2))

changed_num <- function(x, judgement_1, judgement_2){
  b <- b <- x[which(x$Ju1_bin==judgement_1 & x$Ju2_bin==judgement_2),]
  length(b$Ju1_bin)
  
}

tot_changed_num <- function(x, query){
  
  c <- cbind.data.frame(x$Ju1_bin[which(x$Ju1_bin!=x$Ju2_bin)],x$Ju2_bin[which(x$Ju1_bin!=x$Ju2_bin)])
  colnames(c) <- c("initial_judgement","revised_judgement")
  
  c
  if(query == "table") print(c)
  if(query == "total") print(length(c$initial_judgement))}

```

```{r checkingchangesd4}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)

chisq.test(table(dftot$InCS,dftot$condition))
```

- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (increased temporal distance group *N* = `r sum(df3$condition=="long")`; decreased temporal distance group *N* = `r sum(df3$condition=="short")`)

## Study 5: Results


```{r}
#| include: false

df3 <- five

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
#y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="short"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```

```{r}
#| include: false

table(dftot$condition)

g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Increased","Decreased")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")


```

```{r}
#| label: apafg-dch5S5fig2criticalconditionNoExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Pilot Study 5: Responses to critical slide for the increased temporal distance group (N = 47) and the reduced temporal distance group (N = 46); (No exclusions; error bars represent standard error of the proportion)"

suppressWarnings(print(g))

```


```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 5")
g5_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, g4_col, g5_col, file = "plots_col.RData")

```

## Study 6: Method {.smaller}


```{r}
#| label: loadDistancingData6
#| include: false


load("pilot_data/loaded_data/six.RData")
df3 <- six
dftot <- six_tot

variable.names(df3)
df3$condition

#df3 <- six_tot

df3$crt_tot
df3$InCS_rsn
```



:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Deceased
- Anne style vignette in first person: two levels - 5 week deadline vs today

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS_rsn)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Jennifer
- Response to **Alternative** *critical slide*
  - (Continuous/Likert: 1-7)

:::

## Alternative Critical Slide

Jennifer's actions did not harm anyone, or negatively affect anyone. <br>How can there be anything wrong with what she did?<br><br>

1 = *There is nothing wrong*; 7 = *It is definitely wrong*<br><br>

Please indicate how well you can justify your response above<br>
1 = *I can provide a valid reason*; 7 = *I can't think of a reason*


## Study 6: Results


```{r}
#| include: false


t_j2 <- t.test(df3$InCS_ju ~ df3$condition)
t_j3 <- t.test(df3$InCS_rsn ~ df3$condition)
```

- No significant difference in judgment
  - *t*(`r round(t_j2$parameter,digits=2)`) = `r round(t_j2$statistic,digits=2)`, *p* `r paste(p_report(t_j2$p.value))`
<br>(*M*~increased~ = `r round(mean(df3$InCS_ju[which(df3$condition=="long")],na.rm=T), digits = 1)`,
*SD*~increased~ = `r round(sd(df3$InCS_ju[which(df3$condition=="long")],na.rm=T), digits = 1)`,
*M*~decreased~ = `r round(mean(df3$InCS_ju[which(df3$condition=="short")],na.rm=T), digits = 1)`, 
*SD*~decreased~ = `r round(sd(df3$InCS_ju[which(df3$condition=="short")],na.rm=T), digits = 1)`).
- No difference ability to provide reasons 
  - *t*(`r round(t_j3$parameter,digits=2)`) = `r round(t_j3$statistic,digits=2)`, *p* `r paste(p_report(t_j3$p.value))`
<br>(*M*~increased~ = `r round(mean(df3$InCS_rsn[which(df3$condition=="long")],na.rm=T), digits = 1)`,
*SD*~increased~ = `r round(sd(df3$InCS_rsn[which(df3$condition=="long")],na.rm=T), digits = 1)`,
*M*~decreased~ = `r round(mean(df3$InCS_rsn[which(df3$condition=="short")],na.rm=T), digits = 1)`, 
*SD*~decreased~ = `r round(sd(df3$InCS_rsn[which(df3$condition=="short")],na.rm=T), digits = 1)`).

## Study 6: Results

```{r}

df3$InCS_rsn
g <- ggplot(df3, aes(condition, InCS_rsn, fill=factor(condition
                                             #,labels=c("Increased","Decreased")
                                             ))) + 
  ggdist::stat_halfeye(adjust = .5, width = .3, .width = 0, justification = -.3, point_colour = NA) + 
  geom_boxplot(width = .1, outlier.shape = NA) +
  gghalves::geom_half_point(side = "l", range_scale = .4, alpha = .5)+
  stat_summary(fun.y=mean, colour="black", geom="point", shape=23, size=3, show.legend = FALSE)+
  xlab("Condition") +
  ylab("Response to Critical Slide")+
  scale_x_discrete(labels=c("Increased Distance", "Decreased Distance")) +
  
  labs(fill="Condition")+
  theme_bw() +
   theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")



```
```{r}
#| include: true


suppressWarnings(print(g))
```


```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 6")
g6_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, g4_col, g5_col, g6_col, file = "plots_col.RData")

```

## Study 7 Method {.smaller}


```{r}
#| label: loadDistancingData7
#| include: false


load("pilot_data/loaded_data/seven.RData")
df3 <- seven
dftot <- seven_tot

variable.names(df3)
df3$condition

df3$crt_tot

#df3 <- seven_tot
```

:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Deceased
- Anne vignette: two levels - 5 week deadline vs today

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Jennifer
- Response to *critical slide*
  - (categorical: 3 response options)

:::

## Study 7: Results


```{r checkingchangesd7}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)

chisq.test(table(dftot$InCS,dftot$condition))

```

- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (increased temporal distance group *N* = `r sum(df3$condition=="long")`; decreased temporal distance group *N* = `r sum(df3$condition=="short")`)

## Study 7: Results


```{r}
#| include: false

df3 <- seven

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
#y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="short"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```

```{r}
#| include: false

table(dftot$condition)

g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Increased","Decreased")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")


```

```{r}
#| label: apafg-dch5S7fig2criticalconditionNoExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Pilot Study 7: Responses to critical slide for the increased temporal distance group (N = 70) and the reduced temporal distance group (N = 68); (No exclusions; error bars represent standard error of the proportion)"

suppressWarnings(print(g))

```



```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 7")
g7_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, g4_col, g5_col, g6_col, g7_col, file = "plots_col.RData")

```

## Study 8 Method {.smaller}


```{r}
#| label: loadDistancingData8
#| include: false


load("pilot_data/loaded_data/eight.RData")
df3 <- eight
dftot <- eight_tot

variable.names(df3)
df3$condition

df3$crt_tot

df1x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_8/in_distanced_vignette_manip.sav', to.data.frame = TRUE)
df2x <- read.spss('pilot_data/raw_SPSS_files/pilot_study_8/in_distanced_vignette_control.sav', to.data.frame = TRUE)


df <- haven::read_sav('pilot_data/raw_SPSS_files/pilot_study_8/in_distanced_vignette_manip.sav')

N <- length(df1x$gender)+length(df2x$gender)
rm(df1x,df2x)


```

:::{.fragment}
#### Manipulation

- **Temporal Distance**: Increased vs Control
- Modified Incest vignette: set in the past vs the present

:::
:::{.fragment}
#### Participants

- `r length(df3$InCS)` participants; `r sum(df3$gender=="Female")` female, `r sum(df3$gender=="Male")` male;
  - *M*~age~ = `r round(mean(df3$age),digits=2)`, min = `r min(df3$age)`, max = `r max(df3$age)`, *SD* = `r round(sd(df3$age),digits=2)`

:::
:::{.fragment}
#### Scenario & Dependent Variable

- Julie & Mark
- Response to *critical slide*
  - (categorical: 3 response options)

:::

## Julie & Mark: Increased Distance

> 60 years ago, Julie and Mark, who are brother and sister, were travelling together in France. They were both on summer vacation from college. One night they were staying alone in a cabin near the beach. They decided that it would be interesting and fun if they tried making love. At very least it would be a new experience for each of them. Julie was already taking birth control pills, but Mark used a condom too, just to be safe. They both enjoyed it, but they decide not to do it again. They keep that night as a special secret between them, which makes them feel even closer to each other.

## Julie & Mark: Control

> Julie and Mark, who are brother and sister, are travelling together in France. They are both on summer vacation from college. One night they are staying alone in a cabin near the beach. They decide that it would be interesting and fun if they tried making love. At very least it would be a new experience for each of them. Julie was already taking birth control pills, but Mark uses a condom too, just to be safe. They both enjoy it, but they decide not to do it again. They keep that night as a special secret between them, which makes them feel even closer to each other.

## Study 8: Results


```{r checkingchangesd8}

sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

t_j1 <- t.test(df3$InJu1 ~ df3$condition)
t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)

chisq.test(table(dftot$InCS,dftot$condition))

```

- No significant association between experimental condition and response to the critical slide:
  - &Chi;^2^(`r c$parameter`, *N* = `r length(df3$InCS)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r w`, the observed power was `r pw$power`
  - (increased temporal distance group *N* = `r sum(df3$condition=="long")`; decreased temporal distance group *N* = `r sum(df3$condition=="short")`)

## Study 8: Results

```{r}
#| include: false

df3 <- eight

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


#y <- table(df3$condition,df3$Dumb_incl_string)
#y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

x <- df3

se_fun <- function(a,b){
  k <- length(a$gender)
  n <- length(b$gender)
  
  pbar <- k/n
  a$pbar <- pbar
  a$se = sqrt(pbar * (1 - pbar)/n)
  a}
# https://www.r-tutor.com/elementary-statistics/interval-estimation/interval-estimate-population-proportion

y <- rbind(
  se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong and I can provide a valid reason."),]
         ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="long"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="long"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong and I can provide a valid reason."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="There is nothing wrong."),]
          ,x[which(x$condition=="short"),])
  ,se_fun(x[which(x$condition=="short"&x$InCS=="It's wrong but I can't think of a reason."),]
          ,x[which(x$condition=="short"),])
)

y1 <- y %>% select("InCS","condition","pbar","se")
rownames(y1) <- NULL
test

y1 <- y1[!duplicated(y1),]
y1
test1 <- dplyr::left_join(test,y1, by = c("condition","InCS") )

rm(x,y)
```

```{r}
#| include: false

table(dftot$condition)

g <- ggplot(test1, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Increased","Control")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_errorbar(aes(ymin=perc-se, ymax=perc+se), size=.2, width=.2,
               position=position_dodge(.9), color=#"black" #
                 "#5a5a5a"
                 )+
  geom_text(#family = "Times",
            size=3,
            aes( label = scales::percent(perc, accuracy = 1),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            hjust = +1.1,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(#family = "Times", 
            size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(#family="Times",
                                size=12
                                ),
        legend.text=element_text(#family="Times",
                                 size=8
                                 ),
          legend.title=element_text(#family="Times",
                                    size=10
                                    ),
          axis.text=element_text(#family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(#family="Times",
                                  size=12
                                  ),
          strip.text=element_text(#family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")


```

```{r}
#| label: apafg-dch5S8fig2criticalconditionNoExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Pilot Study 8: Responses to critical slide for the increased temporal distance group (N = 128) and the control group (N = 116); (No exclusions; error bars represent standard error of the proportion)"

suppressWarnings(print(g))

```



```{r}

# Saving on object in RData format
remove_geom <- function(ggplot2_object, geom_type) {
  # Delete layers that match the requested type.
  layers <- lapply(ggplot2_object$layers, function(x) {
    if (class(x$geom)[1] == geom_type) {
      NULL
    } else {
      x
    }
  })
  # Delete the unwanted layers.
  layers <- layers[!sapply(layers, is.null)]
  ggplot2_object$layers <- layers
  ggplot2_object
}
p <- g
p <- p +
  rremove("xlab") +
  rremove("ylab") 
# p <- remove_geom(p, "GeomText")
# p <- remove_geom(p, "GeomErrorbar")
p <- p + ggtitle("Study 8")
g8_col <- p
load("plots_col.RData")
save(g1_col, g2_col, g3_col, g4_col, g5_col, g6_col, g7_col, g8_col, file = "plots_col.RData")

```


## Overview


```{r}
#| include: false



load("plots_col.RData")
p <- g8_col
#scale_fill_grey(start = .5, end = .8)
p <- p +
  scale_fill_discrete(labels=c("Increased","Reduced/Control")) +
  theme(legend.text = element_text(size=20)
        ,legend.title=element_text(#family="Times",
                                    size=25
                                    ))

get_legend<-function(a.gplot){
  tmp <- ggplot_gtable(ggplot_build(a.gplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)}

legend_for_plot <- get_legend(p)
#plot.title=element_text(size=25)

overall_plot <- grid.arrange(arrangeGrob(
  g1_col + theme(legend.position="none",
              plot.title=element_text(size=25))
  , g2_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g3_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g4_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g5_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g6_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g7_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  , g8_col + theme(legend.position="none",
                plot.title=element_text(size=25))
  
  , nrow=2,ncol = 4)
  , legend_for_plot
  , nrow=2,heights=c(15, 2)
)

#overall_plot

# 
# load("plots.RData")
# overall_plot <- 
#   ggarrange(g1a
#             #, g1b
#             , g2a
#             , g2b
#             , g3a
#             , g3b
#             , g4a
#             , g4b
#             , g5a
#             #, g5_prob
#             , g5b
#             , g7a
#             , g7b
#             , g8a
#             , g8b
#             , ncol = 4, nrow = 4
#             , l1a
#             , legend = "bottom"
#             #, common.legend = TRUE
#             )
# overall_plot
ggsave("resources/img/overallplot_col.png", plot = overall_plot, width = 20, height = 9, units = "in")




# 
# layers <- lapply(p$layers, function(x) {
#     
#       class(x$geom)[1]
#     
#   })
# layers  
# # Delete the unwanted layers.
#   layers <- layers[!sapply(layers, is.null)]
#   ggplot2_object$layers <- layers
#   ggplot2_object
# 
# class(p$layers[[1]]$geom)
# 
# p$layers[[3]]
# class()
# class(p$layers[[2]])



```

```{r}
#| label: apafg-summaryfigureplot
#| apa-cap: Results of Studies 1-8.
#| out-width: 100%
#| include: true

knitr::include_graphics("resources/img/overallplot_col.png")
```

## Combined Distance Manipulations


```{r}
#| include: false

# create variables for reporting t.tests
t <- t.test(df3$InJu1,df3$InJu2, paired = TRUE)

#chisquare test function

custom_chi <- function(x,y){
  a <- length(x)
  b <- length(y)
  c <- rep(1, a)
  d <- rep(2, b)
  e <- c(c,d)
  f <- c(x, y)
  
  g <- data.frame(e,f)
  h <- table(g$e,g$f)
  suppressWarnings(chisq.test(h))
}

c <- suppressWarnings(custom_chi(df3$InJu1,df3$InJu2))

changed_num <- function(x, judgement_1, judgement_2){
  b <- b <- x[which(x$Ju1_bin==judgement_1 & x$Ju2_bin==judgement_2),]
  length(b$Ju1_bin)
  
}

tot_changed_num <- function(x, query){
  
  c <- cbind.data.frame(x$Ju1_bin[which(x$Ju1_bin!=x$Ju2_bin)],x$Ju2_bin[which(x$Ju1_bin!=x$Ju2_bin)])
  colnames(c) <- c("initial_judgement","revised_judgement")
  
  c
  if(query == "table") print(c)
  if(query == "total") print(length(c$initial_judgement))}

```

```{r}
#| include: false
sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

#t_j1 <- t.test(df3$InJu1 ~ df3$condition)
#t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

# df_aov1 <- function(a){
#     aov <- a
#     print(paste0(c(aov[[1]][["Df"]], " ", ",")[c(1, 4, 3, 2)]))
# }

aov1 <- aov(InJu1~condition,df3)
aov1 <- summary(aov(InJu1~condition,df3))

eta1 <- (aov1[[1]][["Sum Sq"]][1])/((aov1[[1]][["Sum Sq"]][1])+(aov1[[1]][["Sum Sq"]][2]))

tapply(df3$InJu1,df3$condition,descriptives)

#

c <- chisq.test(table(df3$InCS,df3$condition))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)
df_aov(aov1)

```


- Combined analysis without distinguishing between temporal and psychological distance
- New variable with three levels
  - increased distance, decreased distance, and control
- A chi-squared test for association revealed a significant a significant association between experimental condition and response to the critical slide:
  - $\chi$^2^(`r c$parameter`, *N* = `r length(df3$InJu1)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r round(w, digits=2)`, the observed power was `r round(pw$power, digits=2)`

## Plot

```{r}
#| include: false

load("pilot_data/loaded_data/onetoeight.RData")


df3 <- onetoeight


```


```{r}
#| include: false



df3 <- df3[which(is.na(df3$InCS)==FALSE),]

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


abc_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
c <- df3[which(df3$condition==levels(as.factor(df3$condition))[3]),]

a$condition <- droplevels(as.factor(a$condition))
b$condition <- droplevels(as.factor(b$condition))
c$condition <- droplevels(as.factor(c$condition))

#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))
cy <- as.data.frame(table(c$InCS,c$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

cperc <- cy$Freq/length(c$gender)
cy <- cbind(cy,cperc)
colnames(cy) <- c("InCS","condition","Freq","perc")

x <- rbind(ay,by,cy)

x
}

test <- abc_graph()

# y <- table(df3$condition,df3$Dumb_incl_string)
# y <- as.data.frame(y)
# colnames(y) <- c("condition","InCS","Freq")

rm(x,y)

c <- chisq.test(df3$condition,df3$InCS)
c$stdres

```

```{r}
#| include: false


g <- ggplot(test, aes(x=InCS, y=perc, fill=factor(condition
                                             ,labels=c("Control", "Increased Distance","Reduced Distance")
                                             ))) +
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_text(family = "Times", size=4.2,
            aes( label = scales::percent(test$perc, accuracy=1L),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            position = position_dodge(.9),
            fontface='plain'
            )+
  geom_text(family = "Times", size=4.2,
            aes(label = format(Freq),
                y= -3*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
            ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Condition") +
  
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(family="Times",
                                size=12
                                ),
        legend.text=element_text(family="Times",
                                 size=8
                                 ),
          legend.title=element_text(family="Times",
                                    size=10
                                    ),
          axis.text=element_text(family="Times",
                                 colour = "black",
                                 size=8
                                 ),
          axis.ticks.x = element_blank(),
          axis.title=element_text(family="Times",
                                  size=12
                                  ),
          strip.text=element_text(family = "Times",
                                  size = 12
                                  ),
          strip.background = element_rect(fill = "white"),
          legend.position="right")





```

```{r}
#| label: apafg-totdch5allafig2criticalconditionExcl
#| include: true
#| fig-height: 5
#| apa-cap: "Studies 1, 2, 3, 4, 5, 7, and 8: Responses to critical slide depending on condition"


suppressWarnings(print(g))

```



```{r}
#| include: false

c <- chisq.test(df3$InCS,df3$condition)
rownames(rbind(c$observed,c$expected,c$stdres))



ps <- function(y){
  if(as.numeric(sqrt( y*y) ) >3.3) print(paste0(y,"**"), quote = FALSE)
  else if(as.numeric(sqrt( y*y) ) >1.96) print(paste0(y,"*"), quote = FALSE)
  else print(y)}


x <- c$stdres
x <- round(x, digits = 2)

lapply(x, ps)

#c$stdres <- round(c$stdres,digits=3)
#c$stdres <- ps(c$stdres)

ps(x[1])
ps(x[2])
ps(x[3])
x

x <- `colnames<-`(
  cbind.data.frame( c(ps(x[1]) ,ps(x[2]) ,ps(x[3]))
                   ,c(ps(x[4]) ,ps(x[5]) ,ps(x[6]))
                   ,c(ps(x[7]) ,ps(x[8]) ,ps(x[9]))
                   ),
  c("control","long","short")
)

rownames(x) <- row.names(c$observed)  

y <- rbind(round(c$observed), round(c$expected, digits = 2))

c(c$stdres[1])


res <- cbind(c("Observed count","","","Expected count","","","Standardised residuals","",""),
      c("Nothing Wrong","Dumbfounded","Reasons",
        "Nothing Wrong","Dumbfounded","Reasons",
        "Nothing Wrong","Dumbfounded","Reasons"),
      rbind(y,x)
      
      )

row.names(res) <- NULL
colnames(res) <- c("","","Control"
                   , "Long"
                   ,"Short")




```

```{r}
#| include: false
#| results: asis


papaja::apa_table(
   res
   , align = c("l", "l", "c", "c", "c","c","c")
   , caption = "Studies 1, 2, 3, 4, 5, 7, and 8 – Observed counts, expected counts, and standardised residuals for each response to the critical slide depending distance manipulation"
   #, added_stub_head = "Response to critical slide"
   #, col_spanners = makespanners()
   , note = "* = sig. at \\emph{p} < .05; ** = sig. at \\emph{p} < .001"
   , escape = FALSE
   
)

```



```{r}
#| include: false

c$stdres

```


```{r}
#| include: false

table(df3$temp_psych)

```

```{r}
#| include: false

c <- chisq.test(table(df3$InCS,df3$temp_psych))
rownames(rbind(c$observed,c$expected,c$stdres))



ps <- function(y){
  if(as.numeric(sqrt( y*y) ) >3.3) print(paste0(y,"**"), quote = FALSE)
  else if(as.numeric(sqrt( y*y) ) >1.96) print(paste0(y,"*"), quote = FALSE)
  else print(y)}


x <- c$stdres
x <- round(x, digits = 2)

lapply(x, ps)

#c$stdres <- round(c$stdres,digits=3)
#c$stdres <- ps(c$stdres)

ps(x[1])
ps(x[2])
ps(x[3])

x <- `colnames<-`(
  cbind.data.frame( c(ps(x[1]) ,ps(x[2]) ,ps(x[3]))
                   ,c(ps(x[4]) ,ps(x[5]) ,ps(x[6]))
                   ,c(ps(x[7]) ,ps(x[8]) ,ps(x[9]))
                   ,c(ps(x[10]),ps(x[11]),ps(x[12]))
                   ,c(ps(x[13]),ps(x[14]),ps(x[15]))
                   ,c(ps(x[16]),ps(x[17]),ps(x[18]))
                   ),
  c("control_long","control_short","long_long","long_short","short_long","short_short")
)

rownames(x) <- row.names(c$observed)  

y <- rbind(round(c$observed), round(c$expected, digits = 2))

c(c$stdres[1])


res <- cbind(c("Obs","","","Exp","","","Res","",""),
      c("N-W","Dumb","Rsn",
        "N-W","Dumb","Rsn",
        "N-W","Dumb","Rsn"),
      rbind(y,x)
      
      )

row.names(res) <- NULL
colnames(res) <- c(" ","  ","ctrl-long"
                   , "ctrl-short"
                   ,"long-long"
                   ,"long-short"
                   ,"short-long"
                   ,"short-short")




```

## Combined Results: Residuals


```{r}
#| label: apafg-summaryfigureplot1a
#| apa-cap: Results of Studies 1-8.
#| height: 100%
#| include: true

knitr::include_graphics("resources/img/tableoverview1.png")
```




## Different types of Manipulation
#### Temporal vs Psychological vs Control


```{r}
#| include: false


sum(df3$InCS!="There is nothing wrong."&df3$Ju1_bin!="wrong")

#t_j1 <- t.test(df3$InJu1 ~ df3$condition)
#t_paragraph(df3$InJu1, df3$condition, "initial judgement")
#t_paragraph(one$InJu1, one$condition, "initial judgement")
#t_paragraph(two$InJu1, two$condition, "initial judgement")
#t_paragraph(three$InJu1, three$condition, "initial judgement")

aov1 <- aov(InJu1~temp_psych,df3)
aov1 <- summary(aov(InJu1~temp_psych,df3))

eta1 <- (aov1[[1]][["Sum Sq"]][1])/((aov1[[1]][["Sum Sq"]][1])+(aov1[[1]][["Sum Sq"]][2]))

tapply(df3$InJu1,df3$temp_psych,descriptives)

tuk <- TukeyHSD(aov(InJu1~temp_psych,df3))

#(aov[[1]][["Sum Sq"]][1])
#(aov[[1]][["Sum Sq"]][1])/((aov[[1]][["Sum Sq"]][1])+(aov[[1]][["Sum Sq"]][2]))


tuk[[1]][33]
#

c <- chisq.test(table(df3$InCS,df3$temp_psych))
w <- sqrt(c[]$statistic/length(df3$gender))
pw <- pwr.chisq.test(w=w,N=length(df3$InCS),df=(3-1),sig.level = .05)


```



- No significant association between experimental condition and response to the critical slide:
  - $\chi$^2^(`r c$parameter`, *N* = `r length(df3$InJu1)`) = `r round(c$statistic, digits=3)`, *p* `r paste(p_report(c$p.value))`, *V* = `r round(w,digits=2)`, the observed power was `r round(pw$power,digits=2)`. 
  
## Different Types of Manipulation

```{r}
#| include: false

y <- table(df3$condition,df3$InCS)
y <- as.data.frame(y)
colnames(y) <- c("condition","InCS","Freq")

z <- as.data.frame(table(df3$condition,df3$InCS)/length(df3$gender)*2)
perc <- z$Freq
test <- cbind(y,perc)
test$condition
test


df3 <- df3[which(is.na(df3$InCS)==FALSE),]




abcdef_graph <- function(){
  a <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[1]),]
  b <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[2]),]
  c <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[3]),]
  d <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[4]),]
  e <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[5]),]
  f <- df3[which(df3$temp_psych==levels(as.factor(df3$temp_psych))[6]),]

  a#levels(as.factor(df3$temp_psych))[1]
  
  ay <- as.data.frame(table(a$InCS,as.character(a$temp_psych)))
  by <- as.data.frame(table(b$InCS,as.character(b$temp_psych)))
  cy <- as.data.frame(table(c$InCS,as.character(c$temp_psych)))
  dy <- as.data.frame(table(d$InCS,as.character(d$temp_psych)))
  ey <- as.data.frame(table(e$InCS,as.character(e$temp_psych)))
  fy <- as.data.frame(table(f$InCS,as.character(f$temp_psych)))

  aperc <- ay$Freq/length(a$gender)
  ay <- cbind(ay,aperc)
  colnames(ay) <- c("InCS","condition","Freq","perc")
  
  bperc <- by$Freq/length(b$gender)
  by <- cbind(by,bperc)
  colnames(by) <- c("InCS","condition","Freq","perc")
  
  cperc <- cy$Freq/length(c$gender)
  cy <- cbind(cy,cperc)
  colnames(cy) <- c("InCS","condition","Freq","perc")
  
  dperc <- dy$Freq/length(d$gender)
  dy <- cbind(dy,dperc)
  colnames(dy) <- c("InCS","condition","Freq","perc")

  eperc <- ey$Freq/length(e$gender)
  ey <- cbind(ey,eperc)
  colnames(ey) <- c("InCS","condition","Freq","perc")
  
  fperc <- fy$Freq/length(f$gender)
  fy <- cbind(fy,fperc)
  colnames(fy) <- c("InCS","condition","Freq","perc")
  
  cx <- rbind(ay,by,cy,dy,ey,fy)
  
  cx
}

test2 <- abcdef_graph()


ab_graph <- function(){
a <- df3[which(df3$condition==levels(as.factor(df3$condition))[1]),]
a$condition <- droplevels(as.factor(a$condition))
b <- df3[which(df3$condition==levels(as.factor(df3$condition))[2]),]
b$condition <- droplevels(as.factor(b$condition))
#levels(as.factor(df3$condition))[1]

ay <- as.data.frame(table(a$InCS,a$condition))
by <- as.data.frame(table(b$InCS,b$condition))

aperc <- ay$Freq/length(a$gender)
ay <- cbind(ay,aperc)
colnames(ay) <- c("InCS","condition","Freq","perc")

bperc <- by$Freq/length(b$gender)
by <- cbind(by,bperc)
colnames(by) <- c("InCS","condition","Freq","perc")

c <- rbind(ay,by)

c
}

test <- ab_graph()

# y <- table(df3$condition,df3$Dumb_incl_string)
# y <- as.data.frame(y)
# colnames(y) <- c("condition","InCS","Freq")

rm(x,y)
```

```{r}
#| include: false


g <- ggplot(test2, aes(x=InCS, y=perc, fill=factor(condition
                                                   ,labels=c(#"no manipulation"
                                                     "ctrl / long"
                                                     , "ctrl / short"
                                                     ,"long / long"
                                                     ,"long / short"
                                                     ,"short / long"
                                                     ,"short / short")
)))+
  scale_y_continuous(limits = c(-.03,1),
                     labels = percent_format()
  )+ 
  geom_col(position = "dodge",
           color="black",
           size=.2
  )+
  geom_text(family = "Times", size=2.5,
            aes( label = scales::percent(test2$perc,accuracy = 1L),
                 y= perc ),
            stat= "identity",
            vjust = -.5,
            position = position_dodge(.9),
            fontface='plain'
  )+
  geom_text(family = "Times", size=3.2,
            aes(label = format(Freq),
                y= -2.5*(..count../100)/(..count..)),
            stat= "count",
            position = position_dodge(0.9),
            #vjust = -.05,
            fontface='plain'
  ) +
  xlab("Response to Critical Slide") +
  ylab("Percentage of participants selecting each response")+
  scale_x_discrete(labels=c("Nothing Wrong", "Dumbfounded","Reasons")) +
  #scale_fill_grey(start = .5, end = .8) +
  labs(fill="Temporal /\n Psychological") +
  
  #theme_apa() +
  theme_bw() +
  theme(plot.title=element_text(family="Times",
                                size=12
  ),
  legend.text=element_text(family="Times",
                           size=8
  ),
  legend.title=element_text(family="Times",
                            size=9
  ),
  axis.text=element_text(family="Times",
                         colour = "black",
                         size=8
  ),
  axis.ticks.x = element_blank(),
  axis.title=element_text(family="Times",
                          size=12
  ),
  strip.text=element_text(family = "Times",
                          size = 12
  ),
  strip.background = element_rect(fill = "white"),
  legend.position="right")

g



```

```{r}
#| include: true
#| label: apafg-summaryfigureplotoverallExcl
#| apa-cap: Response to the critical slide depending in different distancing manipulations across all pilot studies
#| out-width: 100%



suppressWarnings(print(g))

```





## Residuals


```{r}
#| label: apafg-summaryfigureplot1b
#| apa-cap: Results of Studies 1-8.
#| include: true

knitr::include_graphics("resources/img/tableoverview2.png")
```

```{r}
#| include: false
#res
#flextable(res)

tibble(res) %>%
  flextable() %>%
  #theme_apa() %>%
  flextable::line_spacing(space = .1, part = "all"#, unit = "mm"
                          ) %>%
  # padding(padding.top = 5, padding.bottom = 5) %>%
   align(align = c("left","left","center","center","center","center","center","center")) %>%
  #align_nottext_col(align = "center") %>%
  autofit()

```


```{r}
#| label: apatb-overall
#| include: false
#| results: asis


papaja::apa_table(
   res
   , align = c("l", "l", "c", "c", "c","c","c")
   , caption = "Studies 1, 2, 3, 4, 5, 7, and 8 – Observed counts, expected counts, and standardised residuals for each response to the critical slide depending on distance manipulation"
   #, added_stub_head = "Response to critical slide"
   #, col_spanners = makespanners()
   , note = "* = sig. at \\emph{p} < .05; ** = sig. at \\emph{p} < .001. Obs = Observed Count; Exp = Expected Count; Res = Standardized Residuals. N-W = Nothing Wrong; Dumb = Dumbfounded; Rsn = Reasons"
   , escape = FALSE
   
)

```

## Summary & Follow-up {.smaller}

- Weak effect for Distance
  - Temporal distance manipulations appear to be more reliable
  - Can be confounded
    - 60 years in past
    - Cognitive Load? 

### Looking forward
- Temporal Distance
  - long vs short
  - long vs control
- 2 x 2 Temporal x Psychological

# Thank You for Listening

## References {.smallest}






